<div class="grid grid-cols-2 max-lg:grid-cols-1 mx-20 mt-4">
  <div class="ms-12">
    <p class="text-3xl font-medium">Checkout</p>

    <div>
      <form
        [formGroup]="checkoutForm"
        (ngSubmit)="submitForm()"
        id="checkout-form"
      >
        <p class="text-xl font-medium">Personal information:</p>
        <div class="grid grid-cols-2 max-md:grid-cols-1">
          <div class="flex flex-col">
            <label class="text-gray-500 font-medium mb-2">First Name</label>
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="firstName"
            />
            <label class="text-gray-500 font-medium mt-4 mb-2">Email</label>
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="email"
              formControlName="email"
            />
          </div>

          <div class="flex flex-col">
            <label class="text-gray-500 font-medium mb-2">Last Name</label>
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="lastName"
            />
            <label class="text-gray-500 font-medium mt-4 mb-2">Phone</label>
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="phone"
            />
          </div>
        </div>
        <p class="text-xl font-medium pt-8">Delivery Details:</p>
        <div class="grid grid-cols-2 max-md:grid-cols-1">
          <div class="flex flex-col">
            <label class="text-gray-500 font-medium mb-2">Country/Region</label>
            <select
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="country"
            >
              <option *ngFor="let country of countries">
                {{ country.name }}
              </option>
            </select>
            <label class="text-gray-500 font-medium mt-4 mb-2">Street</label>
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="street"
            />
          </div>

          <div class="flex flex-col">
            <label class="text-gray-500 font-medium mb-2">Town/City</label>
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="city"
            />
            <label class="text-gray-500 font-medium mt-4 mb-2">Postcode</label>
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="postcode"
            />
          </div>
        </div>
        <div class="grid grid-cols-2 max-md:grid-cols-1">
          <div class="flex flex-col">
            <label class="text-gray-500 font-medium mt-4 mb-2"
              >Apt/Suit/Unit</label
            >
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="apartment"
            />
          </div>
          <div class="flex flex-col">
            <label class="text-gray-500 font-medium mb-2 mt-4"
              >Packaging Type</label
            >
            <select
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="packagingType"
            >
              <option value="Without Plastic">Without Palastic</option>
              <option value="With Plastic">With Palastic</option>
            </select>
          </div>
        </div>
        <p class="text-xl font-medium pt-8">Payment:</p>
        <div class="flex flex-col">
          <div>
            <mat-radio-group
              aria-label="Select an option"
              [(ngModel)]="paymentType"
              (change)="setCardPayment()"
              formControlName="paymentType"
            >
              <mat-radio-button value="delivery">
                Pay on deliver
              </mat-radio-button>
              <mat-radio-button value="card"
                >Credit or debit card</mat-radio-button
              >
            </mat-radio-group>
          </div>
        </div>
        <div
          class="grid grid-cols-4 mt-4 max-md:grid-cols-1"
          [ngClass]="isCardPayment ? '' : 'hidden'"
        >
          <div class="col-span-2 flex flex-col">
            <label class="text-gray-500 font-medium mb-2">Card Number</label>
            <input
              class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%]"
              type="text"
              formControlName="cardNumber"
            />
          </div>
          <div class="flex max-md:flex-col space-x-2 max-md:space-x-0">
            <div class="col-span-1 flex flex-col w-[80%]">
              <label class="text-gray-500 font-medium mb-2 max-md:mt-2"
                >Expiration Date</label
              >
              <input
                class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200"
                type="text"
                formControlName="expirationDate"
              />
            </div>
            <div class="col-span-1 flex flex-col w-[80%]">
              <label class="text-gray-500 font-medium mb-2 max-md:mt-2"
                >CVV code</label
              >
              <input
                class="bg-white p-2 rounded-lg border border-gray-300 shadow-md shadow-gray-200"
                type="text"
                formControlName="cvv"
              />
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
  <div class="mx-36 max-lg:mx-12 max-lg:mt-8 mt-14">
    <p class="text-xl font-medium">Your order:</p>
    <div class="flex justify-between">
      <p class="text-gray-500">Subtotal:</p>
      <p class="text-gray-500">E£{{ cartTotal }}</p>
    </div>
    <div class="flex justify-between border-b-2 border-gray-200">
      <p class="text-gray-500">Delivery:</p>
      <p class="text-gray-500">
        <span *ngIf="cartTotal > 200">(Free Shipping)</span>
        E£{{ cartTotal > 200 || cartTotal == 0 ? 0 : deliveryAmount }}
      </p>
    </div>
    <div class="mt-2 border-b-2 border-gray-200 pb-4">
      <p class="text-xl font-medium">Copoun Code:</p>
      <div class="flex max-md:flex-col">
        <input
          class="bg-white p-1 rounded-lg border border-gray-300 shadow-md shadow-gray-200 w-[80%] max-md:w-[100%] max-md:mb-4"
          type="text"
        />
        <button
          class="rounded border-2 border-transparent text-white bg-[#aa0082] py-2 px-5 ml-2 hover:bg-gray-50 hover:border-2 hover:border-[#aa0082] hover:text-gray-800 hover:transition-all]"
        >
          Apply
        </button>
      </div>
    </div>

    <div class="flex justify-between mt-2">
      <p class="text-xl font-medium">Total:</p>
      <p class="text-xl font-medium">
        E£{{
          cartTotal > 200 || cartTotal == 0
            ? cartTotal
            : cartTotal + deliveryAmount
        }}
      </p>
    </div>
    <button
      type="submit"
      form="checkout-form"
      class="block w-full rounded text-white bg-[#aa0082] p-4 text-sm font-medium transition hover:scale-105 mt-4 shadow-md shadow-gray-200"
    >
      Purchase
    </button>
    <div
      *ngFor="let product of cartProducts"
      class="flex justify-between border-b-2 border-gray-200 mt-8"
    >
      <div class="w-24 h-24">
        <img class="rounded-full" [src]="product.image_url" />
      </div>

      <div>
        <p class="pt-6 font-medium text-gray-700 text-lg overflow-hidden h-12">
          {{ product.name }}
        </p>
        <span class="pt-4 text-lg text-gray-400 font-medium"
          >x{{ product.quantity }}</span
        >
      </div>

      <div class="flex flex-col">
        <button
          matTooltip="Remove Product From Cart"
          [matTooltipPosition]="'below'"
          class="hover:bg-gray-100 w-12 h-12 rounded-full text-gray-500 font-medium"
          (click)="removeProductFromCart(product)"
        >
          <mat-icon>delete_outline</mat-icon>
        </button>
        <p class="text-gray-600 ps-2">E£{{ product.price }}</p>
      </div>
    </div>
  </div>
</div>
